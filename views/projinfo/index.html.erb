<!--
  Projinfo ERB template
  Expects a list of projects from projinfo \-\-json.
-->
<table class = "table table-striped table-condensed dataTable no-footer">
<tr>
  <th>Project</th>
  <th title="The total usage for this project">Used[h]</th>
  <th title="The allocation for this project">Allocated[h]</th>
  <th title="The partition/queue the usage is reported for">Queue</th>
</tr>
<% @user_projects.each do |project| %>
<tr>
  <td><%= project["project"] %></td>
  <td title="Usage is reported in <%= project["unit_desc"] %> per rolling 30 day window">
  <% if project["used"].to_f > 0.9*project["allocated"].to_f %>
    <i title="Warning! You are within 90% of your allocation" class="fa fa-warning" style="font-size: 1.25rem; color: red" aria-hidden="true"></i>
  <% elsif project["used"].to_f > 0.8*project["allocated"].to_f %>
    <i title="Warning! You are within 80% of your allocation" class="fa fa-warning" style="font-size: 1.25rem; color: #f2a60c" aria-hidden="true"></i>
  <% end %>
  <%= project["used"].to_f.round(2) %>
  </td>
  <td title="Allocation is reported in <%= project["unit_desc"] %> per rolling 30 day window"><%= project["allocated"] %></td>
  <td title="The system the queue belongs to"><%= project["queue"] %></td>
</tr>
<% project["users"].each do |user| %>
<tr>
  <td title="Usage for user <%= user["username"] %> in project <%= project["project"] %>" style = "padding-left: 2em"><%= user["username"] %></td>
  <td title="Usage is reported in <%= project["unit_desc"] %> per rolling 30 day window"><%= user["used"].to_f.round(2) %></td>
  <td></td>
  <td></td>
</tr>
<%end%>
<%end%>
</table>
<p>Please see <a href = "https://www.c3se.chalmers.se/documentation/running_jobs/">Running jobs article at C3SE website</a> for more information.</p>
